# geo-base ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ å¼•ãç¶™ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

**ä½œæˆæ—¥**: 2025-12-12  
**æœ€çµ‚æ›´æ–°**: 2025-12-14  
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: geo-base - åœ°ç†ç©ºé–“ã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚·ã‚¹ãƒ†ãƒ   
**ãƒªãƒã‚¸ãƒˆãƒª**: https://github.com/mopinfish/geo-base  
**æœ¬ç•ªURL (API)**: https://geo-base-puce.vercel.app/  
**æœ¬ç•ªURL (MCP)**: https://geo-base-mcp.fly.dev/  
**æœ¬ç•ªURL (Admin)**: https://geo-base-app.vercel.app/  
**APIãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.4.0  
**MCPãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.2.0  
**Admin UIãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.7.0

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### ç›®çš„
åœ°ç†ç©ºé–“ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ©ã‚¹ã‚¿/ãƒ™ã‚¯ã‚¿ã‚¿ã‚¤ãƒ«ï¼‰ã‚’é…ä¿¡ã™ã‚‹ã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã€‚MCPã‚µãƒ¼ãƒãƒ¼ã‚’é€šã˜ã¦Claudeã¨ã®é€£æºã‚‚å¯èƒ½ã«ã™ã‚‹ã€‚

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Admin UI      â”‚     â”‚   MCP Server    â”‚     â”‚   å¤–éƒ¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ  â”‚
â”‚   (Next.js)     â”‚     â”‚   (FastMCP)     â”‚     â”‚   (MapLibreç­‰)   â”‚
â”‚   âœ… Step3.8å®Œäº†â”‚     â”‚   âœ… Fly.ioç¨¼åƒ â”‚     â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Tile Server API     â”‚
                    â”‚   (FastAPI on Vercel)   â”‚
                    â”‚   âœ… æœ¬ç•ªç¨¼åƒä¸­         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL+PostGISâ”‚  â”‚ Supabase Storage â”‚  â”‚   External COG    â”‚
â”‚    (Supabase)     â”‚  â”‚   (PMTiles)      â”‚  â”‚   (S3, HTTP)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. å®Œäº†ã—ãŸä½œæ¥­

### ãƒ•ã‚§ãƒ¼ã‚º1: ã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼APIï¼ˆå®Œäº†ï¼‰

| Step | å†…å®¹ | çŠ¶æ…‹ |
|------|------|------|
| 1.1 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸè¨­å®š | âœ… å®Œäº† |
| 1.2 | FastAPIã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼æ§‹ç¯‰ | âœ… å®Œäº† |
| 1.3 | å‹•çš„ã‚¿ã‚¤ãƒ«ç”Ÿæˆæ©Ÿèƒ½ã®å……å®Ÿ | âœ… å®Œäº† |
| 1.4 | Vercelãƒ‡ãƒ—ãƒ­ã‚¤ | âœ… å®Œäº† |
| 1.5 | ãƒ©ã‚¹ã‚¿ã‚¿ã‚¤ãƒ«å¯¾å¿œï¼ˆCOG/GeoTIFFï¼‰ | âš ï¸ éƒ¨åˆ†å®Œäº†ï¼ˆVercelã§ã¯å‹•ä½œä¸å¯ï¼‰ |
| 1.6 | PMTileså¯¾å¿œ | âœ… å®Œäº† |
| 1.7 | èªè¨¼æ©Ÿèƒ½ï¼ˆSupabase Authï¼‰ | âœ… å®Œäº† |

### ãƒ•ã‚§ãƒ¼ã‚º2: MCPã‚µãƒ¼ãƒãƒ¼ï¼ˆå®Œäº†ï¼‰

| Step | å†…å®¹ | çŠ¶æ…‹ |
|------|------|------|
| 2.1 | FastMCPã‚µãƒ¼ãƒãƒ¼åŸºç›¤æ§‹ç¯‰ | âœ… å®Œäº† |
| 2.2 | ãƒ­ãƒ¼ã‚«ãƒ«å‹•ä½œç¢ºèªãƒ»ãƒ†ã‚¹ãƒˆ | âœ… å®Œäº† |
| 2.3 | Fly.ioãƒ‡ãƒ—ãƒ­ã‚¤ | âœ… å®Œäº† |
| 2.4 | Claude Desktopé€£æºç¢ºèª | âœ… å®Œäº† |
| 2.4-A | ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«è¿½åŠ  | âœ… å®Œäº† |
| 2.4-B | CRUDãƒ„ãƒ¼ãƒ«è¿½åŠ  | âœ… å®Œäº† |

### ãƒ•ã‚§ãƒ¼ã‚º3: ç®¡ç†ç”»é¢ï¼ˆé€²è¡Œä¸­ï¼‰

| Step | å†…å®¹ | çŠ¶æ…‹ |
|------|------|------|
| 3.1 | Next.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š | âœ… å®Œäº† |
| 3.2 | Supabase Authé€£æº | âœ… å®Œäº† |
| 3.3 | ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆç®¡ç†UI | âœ… å®Œäº† |
| 3.4 | ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†UI | âœ… å®Œäº† |
| 3.5 | è¨­å®šç”»é¢ | âœ… å®Œäº† |
| 3.7 | GeoJSONã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ | âœ… å®Œäº† |
| 3.8 | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†UI | âœ… å®Œäº† |
| 3.9 | ãƒãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼ | ğŸ“‹ æœªç€æ‰‹ |

---

## 3. ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
geo-base/
â”œâ”€â”€ api/                          # FastAPI ã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py              # èªè¨¼ãƒ»JWTæ¤œè¨¼ã€Step 1.7ã€‘
â”‚   â”‚   â”œâ”€â”€ config.py            # è¨­å®šç®¡ç†ï¼ˆpydantic-settingsï¼‰
â”‚   â”‚   â”œâ”€â”€ database.py          # DBæ¥ç¶šï¼ˆã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹å¯¾å¿œï¼‰
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPIã‚¢ãƒ—ãƒªãƒ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”‚   â”‚                        # â€»ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ã€Step 3.8ã€‘
â”‚   â”‚   â”œâ”€â”€ pmtiles.py           # PMTilesãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã€Step 1.6ã€‘
â”‚   â”‚   â”‚                        # â€»aiopmtiles Enumå¯¾å¿œä¿®æ­£ã€Step 3.8ã€‘
â”‚   â”‚   â”œâ”€â”€ raster_tiles.py      # ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”‚                        # â€»rio-tiler Infoå±æ€§å¯¾å¿œä¿®æ­£ã€Step 3.8ã€‘
â”‚   â”‚   â””â”€â”€ tiles.py             # ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ data/                    # MBTilesãƒ•ã‚¡ã‚¤ãƒ«æ ¼ç´ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ç”¨ï¼‰
â”‚   â”œâ”€â”€ index.py                 # Vercelã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ pyproject.toml
â”‚   â”œâ”€â”€ uv.lock
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ runtime.txt
â”‚   â”œâ”€â”€ .env.example
â”‚   â””â”€â”€ .python-version
â”œâ”€â”€ mcp/                          # MCPã‚µãƒ¼ãƒãƒ¼ã€Step 2å®Œäº†ã€‘
â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ tilesets.py          # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆé–¢é€£ãƒ„ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ features.py          # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼é–¢é€£ãƒ„ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ geocoding.py         # ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«ã€Step 2.4-Aã€‘
â”‚   â”‚   â””â”€â”€ crud.py              # CRUDæ“ä½œãƒ„ãƒ¼ãƒ«ã€Step 2.4-Bã€‘
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ conftest.py
â”‚   â”‚   â”œâ”€â”€ test_tools.py        # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆãƒ»ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test_geocoding.py    # ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ†ã‚¹ãƒˆã€Step 2.4-Aã€‘
â”‚   â”‚   â”œâ”€â”€ test_crud.py         # CRUDãƒ†ã‚¹ãƒˆã€Step 2.4-Bã€‘
â”‚   â”‚   â””â”€â”€ live_test.py         # ãƒ©ã‚¤ãƒ–ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ server.py                # FastMCPã‚µãƒ¼ãƒãƒ¼æœ¬ä½“ï¼ˆ16ãƒ„ãƒ¼ãƒ«ï¼‰
â”‚   â”œâ”€â”€ config.py                # è¨­å®šç®¡ç†
â”‚   â”œâ”€â”€ pyproject.toml
â”‚   â”œâ”€â”€ uv.lock
â”‚   â”œâ”€â”€ Dockerfile               # Fly.ioç”¨ã€Step 2.3ã€‘
â”‚   â”œâ”€â”€ fly.toml                 # Fly.ioè¨­å®šã€Step 2.3ã€‘
â”‚   â”œâ”€â”€ .dockerignore            # Dockeré™¤å¤–è¨­å®šã€Step 2.3ã€‘
â”‚   â”œâ”€â”€ README.md                # æ—¥æœ¬èªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ .env.example
â”‚   â”œâ”€â”€ .python-version
â”‚   â””â”€â”€ claude_desktop_config.example.json
â”œâ”€â”€ app/                          # Next.jsç®¡ç†ç”»é¢ã€Step 3.8å®Œäº†ã€‘
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ layout.tsx       # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx         # ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆæ•°è¡¨ç¤ºä¿®æ­£æ¸ˆã¿ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ globals.css      # ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx     # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã€Step 3.2ã€‘
â”‚   â”‚   â”‚   â”œâ”€â”€ tilesets/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx     # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆä¸€è¦§ã€Step 3.3ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆæ–°è¦ä½œæˆã€Step 3.3ã€‘
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆè©³ç´°ã€Step 3.3ã€‘
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ edit/
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ page.tsx # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆç·¨é›†ã€Step 3.3ã€‘
â”‚   â”‚   â”‚   â”œâ”€â”€ features/        # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†ã€Step 3.4, 3.7ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx     # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§ï¼ˆã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³è¿½åŠ ï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼æ–°è¦ä½œæˆ
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ import/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx # GeoJSONã‚¤ãƒ³ãƒãƒ¼ãƒˆã€Step 3.7ã€‘
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ page.tsx # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼è©³ç´°
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ edit/
â”‚   â”‚   â”‚   â”‚           â””â”€â”€ page.tsx # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ç·¨é›†
â”‚   â”‚   â”‚   â”œâ”€â”€ datasources/     # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†ã€Step 3.8ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx     # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ä¸€è¦§
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ new/
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ page.tsx # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ–°è¦ç™»éŒ²
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ page.tsx # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è©³ç´°
â”‚   â”‚   â”‚   â””â”€â”€ settings/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx     # è¨­å®šç”»é¢ã€Step 3.5ã€‘
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ sidebar.tsx   # ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ admin-layout.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ tilesets/        # ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆé–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Step 3.3ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ tileset-form.tsx      # ä½œæˆ/ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ delete-tileset-dialog.tsx # å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ features/        # ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼é–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Step 3.4, 3.7ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ feature-form.tsx      # ä½œæˆ/ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ delete-feature-dialog.tsx # å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ geojson-dropzone.tsx  # ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€Step 3.7ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ geojson-preview.tsx   # åœ°å›³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€Step 3.7ã€‘
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ settings/        # è¨­å®šé–¢é€£ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Step 3.5ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ profile-form.tsx      # ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ password-form.tsx     # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ map/             # åœ°å›³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Step 3.4ã€‘
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ map-view.tsx # MapLibre GL JS ãƒ©ãƒƒãƒ‘ãƒ¼
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ ui/              # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚       â”œâ”€â”€ alert.tsx    # ã‚¢ãƒ©ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€Step 3.8ã€‘
â”‚   â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ card.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ input.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ label.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ table.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ select.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ dialog.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ dropdown-menu.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ switch.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ textarea.tsx
â”‚   â”‚   â”‚       â”œâ”€â”€ alert-dialog.tsx
â”‚   â”‚   â”‚       â””â”€â”€ separator.tsx
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts           # APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”‚                    # â€»Datasourceå‹ãƒ»APIè¿½åŠ ã€Step 3.8ã€‘
â”‚   â”‚   â”‚   â”œâ”€â”€ utils.ts         # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆcné–¢æ•°ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ supabase/        # Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã€Step 3.2ã€‘
â”‚   â”‚   â”‚       â”œâ”€â”€ client.ts    # ãƒ–ãƒ©ã‚¦ã‚¶ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚       â”œâ”€â”€ server.ts    # ã‚µãƒ¼ãƒãƒ¼ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚       â””â”€â”€ middleware.ts # ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›´æ–°
â”‚   â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ use-api.ts       # èªè¨¼ä»˜ãAPIãƒ•ãƒƒã‚¯ã€Step 3.3ã€‘
â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚       â””â”€â”€ index.ts         # å‹å®šç¾©
â”‚   â”œâ”€â”€ middleware.ts            # Next.jsèªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€Step 3.2ã€‘
â”‚   â”œâ”€â”€ public/                  # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ .env.example             # ç’°å¢ƒå¤‰æ•°ã‚µãƒ³ãƒ—ãƒ«
â”‚   â”œâ”€â”€ package.json             # ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 0.7.0
â”‚   â”œâ”€â”€ package-lock.json
â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”œâ”€â”€ next.config.ts
â”‚   â”œâ”€â”€ postcss.config.mjs
â”‚   â”œâ”€â”€ components.json          # shadcn/uiè¨­å®š
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ docker-compose.yml
â”‚   â””â”€â”€ postgis-init/
â”‚       â”œâ”€â”€ 01_init.sql          # â€»typeåˆ¶ç´„ã«'pmtiles'è¿½åŠ ã€Step 3.8ã€‘
â”‚       â”œâ”€â”€ 02_raster_schema.sql # raster_sourcesãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
â”‚       â”œâ”€â”€ 03_pmtiles_schema.sql # pmtiles_sourcesãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
â”‚       â””â”€â”€ 04_rls_policies.sql  # â€»ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ç°¡ç•¥åŒ–ã€Step 3.8ã€‘
â”œâ”€â”€ packages/                     # å…±æœ‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆæœªå®Ÿè£…ï¼‰
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ setup.sh
â”‚   â”œâ”€â”€ seed.sh
â”‚   â”œâ”€â”€ seed_sample_data.fish    # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆfish shellï¼‰ã€Step 3.4ã€‘
â”‚   â””â”€â”€ seed_sample_data.py      # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆPythonï¼‰ã€Step 3.4ã€‘
â”œâ”€â”€ vercel.json                   # APIç”¨ï¼ˆæ—¢å­˜ã®ã¾ã¾ï¼‰
â”œâ”€â”€ DEPLOY.md
â”œâ”€â”€ TESTING.md                    # å‹•ä½œç¢ºèªæ‰‹é †ã€Step 2.4-Bã€‘
â”œâ”€â”€ LOCAL_DEVELOPMENT.md          # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚¬ã‚¤ãƒ‰ã€Step 3.1ã€‘
â”œâ”€â”€ HANDOVER.md                   # æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â”œâ”€â”€ PROJECT_ROADMAP.md            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
â””â”€â”€ README.md
```

---

## 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

| ãƒ†ãƒ¼ãƒ–ãƒ«å | èª¬æ˜ |
|-----------|------|
| tilesets | ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ |
| features | ãƒ™ã‚¯ã‚¿ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆPostGIS geometryï¼‰ |
| tile_files | é™çš„ã‚¿ã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å‚ç…§æƒ…å ± |
| pmtiles_sources | PMTilesãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚½ãƒ¼ã‚¹æƒ…å ±ã€Step 3.8ã€‘ |
| raster_sources | COGãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚½ãƒ¼ã‚¹æƒ…å ±ã€Step 3.8ã€‘ |

### pmtiles_sources ãƒ†ãƒ¼ãƒ–ãƒ«ã€Step 3.8ã€‘

```sql
CREATE TABLE pmtiles_sources (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    tileset_id UUID NOT NULL UNIQUE REFERENCES tilesets(id) ON DELETE CASCADE,
    pmtiles_url TEXT NOT NULL,
    storage_provider VARCHAR(50) DEFAULT 'supabase',  -- 'supabase', 's3', 'http'
    tile_type VARCHAR(20),        -- 'vector', 'raster', 'unknown'
    tile_compression VARCHAR(20), -- 'gzip', 'zstd', 'br', 'none'
    min_zoom INTEGER,
    max_zoom INTEGER,
    bounds JSONB,                 -- [west, south, east, north]
    center JSONB,                 -- [lng, lat, zoom]
    layers JSONB DEFAULT '[]',    -- Vector layer info for MVT
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### raster_sources ãƒ†ãƒ¼ãƒ–ãƒ«ã€Step 3.8ã€‘

```sql
CREATE TABLE raster_sources (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    tileset_id UUID NOT NULL UNIQUE REFERENCES tilesets(id) ON DELETE CASCADE,
    cog_url TEXT NOT NULL,
    storage_provider VARCHAR(50) DEFAULT 'http',
    band_count INTEGER,
    band_descriptions JSONB DEFAULT '[]',
    statistics JSONB DEFAULT '{}',
    native_crs VARCHAR(50),
    native_resolution FLOAT,
    recommended_min_zoom INTEGER,
    recommended_max_zoom INTEGER,
    bounds JSONB,
    center JSONB,
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### åˆ¶ç´„

- 1ã¤ã®ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã«ã¯æœ€å¤§1ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆPMTiles OR COGã€ä¸¡æ–¹ã¯ä¸å¯ï¼‰
- `tileset_id`ã«UNIQUEåˆ¶ç´„

---

## 5. Step 3.8 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†UI è©³ç´°

### å®Ÿè£…å†…å®¹

| ã‚µãƒ–ã‚¹ãƒ†ãƒƒãƒ— | å†…å®¹ | ãƒ•ã‚¡ã‚¤ãƒ« |
|-------------|------|---------|
| 3.8.1 | APIæ‹¡å¼µï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰ | `api/lib/main.py` |
| 3.8.2 | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ä¸€è¦§UI | `app/src/app/datasources/page.tsx` |
| 3.8.3 | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ–°è¦ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ  | `app/src/app/datasources/new/page.tsx` |
| 3.8.4 | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è©³ç´°ãƒšãƒ¼ã‚¸ | `app/src/app/datasources/[id]/page.tsx` |
| 3.8.5 | æ¥ç¶šãƒ†ã‚¹ãƒˆæ©Ÿèƒ½ | å„ãƒšãƒ¼ã‚¸ã«çµ±åˆ |

### APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èªè¨¼ | èª¬æ˜ |
|---------|------|------|------|
| GET | `/api/datasources` | ä¸è¦â€» | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ä¸€è¦§ |
| GET | `/api/datasources/{id}` | æ¡ä»¶ä»˜ã | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è©³ç´° |
| POST | `/api/datasources` | å¿…é ˆ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ä½œæˆ |
| DELETE | `/api/datasources/{id}` | å¿…é ˆ | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å‰Šé™¤ |
| POST | `/api/datasources/{id}/test` | å¿…é ˆ | æ¥ç¶šãƒ†ã‚¹ãƒˆ |

â€» å…¬é–‹ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¯èªè¨¼ä¸è¦ã§å–å¾—å¯èƒ½

### æ©Ÿèƒ½

1. **ä¸€è¦§è¡¨ç¤º**: PMTiles/COGã‚’çµ±åˆè¡¨ç¤ºã€ã‚¿ã‚¤ãƒ—åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
2. **æ–°è¦ç™»éŒ²**: ã‚¿ã‚¤ãƒ—é¸æŠ â†’ ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆé¸æŠ â†’ URLå…¥åŠ› â†’ ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ—ãƒ­ãƒã‚¤ãƒ€è‡ªå‹•æ¤œå‡º
3. **è©³ç´°è¡¨ç¤º**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã€é–¢é€£ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã¸ã®ãƒªãƒ³ã‚¯ã€æ¥ç¶šãƒ†ã‚¹ãƒˆ
4. **æ¥ç¶šãƒ†ã‚¹ãƒˆ**: PMTilesã¯ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—ã€COGã¯æƒ…å ±å–å¾—ã§ç¢ºèª

### ä¿®æ­£ã•ã‚ŒãŸãƒã‚°

| ãƒ•ã‚¡ã‚¤ãƒ« | å•é¡Œ | ä¿®æ­£å†…å®¹ |
|---------|------|---------|
| `api/lib/pmtiles.py` | `reader.header()`ãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ã‚¨ãƒ©ãƒ¼ | `reader.header`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«å¤‰æ›´ã€Enumå€¤ã®`.value`å–å¾— |
| `api/lib/raster_tiles.py` | `info.minzoom`å±æ€§ãŒãªã„ | `getattr()`ã§å®‰å…¨ã«ã‚¢ã‚¯ã‚»ã‚¹ã€`cog.minzoom`ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ |
| `docker/postgis-init/01_init.sql` | `type`åˆ¶ç´„ã«`'pmtiles'`ãŒãªã„ | åˆ¶ç´„ã«è¿½åŠ  |
| `docker/postgis-init/04_rls_policies.sql` | `authenticated`ãƒ­ãƒ¼ãƒ«ãŒãƒ­ãƒ¼ã‚«ãƒ«ã«ãªã„ | ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç”¨ã«å…¨è¨±å¯ãƒãƒªã‚·ãƒ¼ã«å¤‰æ›´ |

---

## 6. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆæœªå®Ÿè£…ï¼‰

### Step 3.9: ãƒãƒƒãƒ—ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼

**ç›®çš„**: Admin UIå†…ã§ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã®åœ°å›³ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º

**å®Ÿè£…æ–¹é‡**:
1. MapLibre GL JS / Mapbox GL JS ã‚’ä½¿ç”¨
2. ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ã«åœ°å›³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’è¿½åŠ 
3. ãƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ï¼ˆMVTï¼‰ã¨PMTilesã®è¡¨ç¤ºå¯¾å¿œ
4. ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®šï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼è‰²ã€ãƒ©ãƒ™ãƒ«ç­‰ï¼‰

**å„ªå…ˆåº¦**: ä¸­

### ~~PMTilesç”¨TileJSONã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¿®æ­£~~ âœ… å®Œäº†

**ç—‡çŠ¶**: pmtilesã‚¿ã‚¤ãƒ—ã®ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã§TileJSONå–å¾—æ™‚ã«500ã‚¨ãƒ©ãƒ¼

**åŸå› **: `generate_pmtiles_tilejson()`é–¢æ•°ã®å‘¼ã³å‡ºã—æ™‚ã«å¼•æ•°ãŒæ­£ã—ããƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚Œã¦ã„ãªã‹ã£ãŸ
- `name` â†’ `tileset_name`ã«å¤‰æ›´ãŒå¿…è¦
- å€‹åˆ¥ã®å¼•æ•°ã‚’`metadata`è¾æ›¸ã«ã¾ã¨ã‚ã‚‹å¿…è¦ãŒã‚ã£ãŸ

**ä¿®æ­£å†…å®¹**:
- `api/lib/main.py`ã®`get_tileset_tilejson`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå†…ã§ã€pmtilesã‚¿ã‚¤ãƒ—ã®å ´åˆã®`generate_pmtiles_tilejson()`å‘¼ã³å‡ºã—ã‚’ä¿®æ­£

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: âœ… ä¿®æ­£å®Œäº†

### æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆVercelï¼‰

**å¯¾è±¡**:
- APIï¼ˆStep 3.8.1ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ ï¼‰
- Admin UIï¼ˆStep 3.8ã®UIæ›´æ–°ï¼‰

**æ‰‹é †**:
```bash
# develop â†’ main ã¸ãƒãƒ¼ã‚¸å¾Œã€è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
# ã¾ãŸã¯æ‰‹å‹•ã§Vercelã«ãƒ—ãƒƒã‚·ãƒ¥
```

**æ³¨æ„ç‚¹**:
- Supabaseã®æœ¬ç•ªDBã«`pmtiles_sources`ã¨`raster_sources`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå¿…è¦
- æœ¬ç•ªã®RLSãƒãƒªã‚·ãƒ¼ã¯`04_rls_policies.sql.supabase`ã‚’ä½¿ç”¨

---

## 7. æ—¢çŸ¥ã®å•é¡Œ

### 1. DBæ¥ç¶šãƒ—ãƒ¼ãƒ«æ¯æ¸‡

**ç—‡çŠ¶**: å¤šæ•°ã®ã‚¿ã‚¤ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ `connection pool exhausted` ã‚¨ãƒ©ãƒ¼

**æš«å®šå¯¾å¿œ**: APIã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•

**æ’ä¹…å¯¾å¿œæ¡ˆ**:
- æ¥ç¶šãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚ºã®èª¿æ•´ï¼ˆ`database.py`ã®`minconn`/`maxconn`ï¼‰
- ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
- Vercel Serverlessç’°å¢ƒã§ã®æ¥ç¶šç®¡ç†æœ€é©åŒ–

### 2. Radix UI + Tailwind CSS v4 äº’æ›æ€§

**ç—‡çŠ¶**: Select, Dialogç­‰ã®ãƒãƒ¼ã‚¿ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œãªã„å ´åˆãŒã‚ã‚‹

**æš«å®šå¯¾å¿œ**: ãƒã‚¤ãƒ†ã‚£ãƒ–HTMLè¦ç´ ã‚’ä½¿ç”¨ï¼ˆãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§ã®ã‚»ãƒ¬ã‚¯ãƒˆï¼‰

**æ’ä¹…å¯¾å¿œæ¡ˆ**:
- Tailwind CSS v3ã¸ã®ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰æ¤œè¨
- shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### 3. ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆã‚¿ã‚¤ãƒ—ã®åˆ¶ç´„

| ã‚¿ã‚¤ãƒ— | ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ç·¨é›† | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ |
|--------|----------------|------------|
| vector | âœ… å¯èƒ½ | âŒ ä¸è¦ï¼ˆPostGISï¼‰ |
| pmtiles | âŒ ä¸å¯ | âœ… å¿…é ˆï¼ˆPMTilesãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ |
| raster | âŒ ä¸å¯ | âœ… å¿…é ˆï¼ˆCOGãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ |

### ~~4. PMTiles TileJSON 500ã‚¨ãƒ©ãƒ¼~~ âœ… ä¿®æ­£æ¸ˆã¿

**ç—‡çŠ¶**: pmtilesã‚¿ã‚¤ãƒ—ã®ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆè©³ç´°ãƒšãƒ¼ã‚¸ã§TileJSONå–å¾—æ™‚ã«500ã‚¨ãƒ©ãƒ¼

**ä¿®æ­£æ¸ˆã¿**: `api/lib/main.py`ã®`generate_pmtiles_tilejson()`å‘¼ã³å‡ºã—ã®å¼•æ•°ã‚’ä¿®æ­£

### 5. Next.js 16 Middlewareè­¦å‘Š

**ç—‡çŠ¶**: ãƒ“ãƒ«ãƒ‰æ™‚ã« `middleware` ãƒ•ã‚¡ã‚¤ãƒ«è¦ç´„ãŒéæ¨å¥¨ã¨ã®è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œã‚‹

**å¯¾å¿œ**: æ¬¡å›ãƒ¡ã‚¸ãƒ£ãƒ¼ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã« `proxy` ã¸ã®ç§»è¡Œã‚’æ¤œè¨

---

## 8. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| ãƒ¬ã‚¤ãƒ¤ãƒ¼ | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å‚™è€ƒ |
|---------|------|-----------|------|
| Admin UI Framework | Next.js | 16.x | App Router |
| Admin UI Language | TypeScript | 5.x | |
| Admin UI Styling | Tailwind CSS | 4.x | |
| Admin UI Components | shadcn/ui | - | æ‰‹å‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— |
| Admin UI Icons | Lucide React | 0.560.x | |
| Admin UI Auth | @supabase/ssr | 0.5.x | ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰èªè¨¼ |
| Admin UI Map | MapLibre GL JS | 4.7.x | åœ°å›³è¡¨ç¤ºã€Step 3.4, 3.7ã€‘ |
| API Framework | FastAPI | 0.115.x | |
| Database | PostgreSQL + PostGIS | 16 + 3.4 | |
| Database Hosting | Supabase | - | Auth, Storageå«ã‚€ |
| API Hosting | Vercel Serverless | Python 3.12 | |
| MCP Framework | FastMCP | 2.14.0 | |
| MCP Hosting | Fly.io | - | SSEãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ |
| MCP Proxy | mcp-proxy | 0.10.0 | ãƒªãƒ¢ãƒ¼ãƒˆæ¥ç¶šç”¨ |
| Package Manager (Python) | uv | latest | |
| Package Manager (Node) | npm | - | |
| Vector Tiles | PostGIS ST_AsMVT | - | |
| PMTiles | aiopmtiles | 0.1.0 | âœ… Vercelã§å‹•ä½œ |
| Raster Tiles | rio-tiler | 7.0+ | âš ï¸ Vercelã§ã¯å‹•ä½œä¸å¯ |
| Authentication | Supabase Auth + PyJWT | - | âœ… JWTæ¤œè¨¼å®Ÿè£…æ¸ˆã¿ |
| Geocoding | Nominatim API | - | OpenStreetMap |
| Tile Format | MVT (pbf), PNG, WebP | - | |

---

## 9. ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### Docker PostgreSQLåˆæœŸåŒ–

```fish
cd /path/to/geo-base/docker

# ãƒœãƒªãƒ¥ãƒ¼ãƒ å‰Šé™¤ã—ã¦å†åˆæœŸåŒ–
docker compose down -v
docker compose up -d

# ãƒ­ã‚°ç¢ºèªï¼ˆã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨ï¼‰
docker compose logs -f postgis
```

### APIèµ·å‹•

```fish
cd /path/to/geo-base/api
uv run uvicorn lib.main:app --reload --port 8000
```

### Admin UIèµ·å‹•

```fish
cd /path/to/geo-base/app
npm run dev
```

### å‹•ä½œç¢ºèªURL

| ã‚µãƒ¼ãƒ“ã‚¹ | URL |
|---------|-----|
| API | http://localhost:8000 |
| Admin UI | http://localhost:3000 |
| API Docs | http://localhost:8000/docs |

---

## 10. æœ¬ç•ªç’°å¢ƒURLä¸€è¦§

| ã‚µãƒ¼ãƒ“ã‚¹ | URL | ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  | çŠ¶æ…‹ |
|---------|-----|----------------|------|
| Admin UI | https://geo-base-app.vercel.app | Vercel | âœ… ç¨¼åƒä¸­ |
| API | https://geo-base-puce.vercel.app | Vercel | âœ… ç¨¼åƒä¸­ |
| MCP Server | https://geo-base-mcp.fly.dev | Fly.io | âœ… ç¨¼åƒä¸­ |

---

## 11. å‚ç…§è³‡æ–™

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `/mnt/project/geolocation-tech-source.txt` - ã‚¿ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰
- `/mnt/project/PROJECT_ROADMAP.md` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
- `/mnt/project/geo-base.txt` - æœ€æ–°ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
- `TESTING.md` - å‹•ä½œç¢ºèªæ‰‹é †
- `LOCAL_DEVELOPMENT.md` - ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚¬ã‚¤ãƒ‰

### å¤–éƒ¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Next.js Documentation](https://nextjs.org/docs)
- [shadcn/ui Documentation](https://ui.shadcn.com/)
- [Supabase Auth (SSR)](https://supabase.com/docs/guides/auth/server-side/nextjs)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [FastMCP Documentation](https://gofastmcp.com/)
- [MCP Specification](https://modelcontextprotocol.io/)
- [PostGIS MVT Functions](https://postgis.net/docs/ST_AsMVT.html)
- [MapLibre GL JS](https://maplibre.org/maplibre-gl-js/docs/)
- [aiopmtiles](https://github.com/developmentseed/aiopmtiles)
- [rio-tiler](https://cogeotiff.github.io/rio-tiler/)

---

## 12. å¤‰æ›´å±¥æ­´

| æ—¥ä»˜ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹ |
|------|-----------|---------|
| 2025-12-12 | 0.1.0 | åˆç‰ˆä½œæˆï¼ˆStep 1.1ã€œ1.4å®Œäº†ï¼‰ |
| 2025-12-12 | 0.2.0 | ãƒ©ã‚¹ã‚¿ã‚¿ã‚¤ãƒ«å¯¾å¿œï¼ˆStep 1.5ï¼‰ã€PMTileså¯¾å¿œï¼ˆStep 1.6ï¼‰è¿½åŠ  |
| 2025-12-12 | 0.3.0 | èªè¨¼æ©Ÿèƒ½ï¼ˆStep 1.7ï¼‰è¿½åŠ  |
| 2025-12-12 | 0.4.0 | MCPã‚µãƒ¼ãƒãƒ¼åŸºç›¤æ§‹ç¯‰ï¼ˆStep 2.1ï¼‰ã€ãƒ†ã‚¹ãƒˆè¿½åŠ ï¼ˆStep 2.2ï¼‰ |
| 2025-12-12 | 0.5.0 | Fly.ioãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆStep 2.3ï¼‰ã€Claude Desktopé€£æºç¢ºèªï¼ˆStep 2.4ï¼‰ |
| 2025-12-12 | 0.6.0 | ã‚¸ã‚ªã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ„ãƒ¼ãƒ«è¿½åŠ ï¼ˆStep 2.4-Aï¼‰ |
| 2025-12-12 | 0.7.0 | CRUDãƒ„ãƒ¼ãƒ«è¿½åŠ ï¼ˆStep 2.4-Bï¼‰ã€Phase 2å®Œäº† |
| 2025-12-13 | 0.8.0 | Next.js Admin UIåŸºç›¤æ§‹ç¯‰ï¼ˆStep 3.1å®Œäº†ï¼‰ |
| 2025-12-13 | 0.9.0 | Supabase Authé€£æºï¼ˆStep 3.2å®Œäº†ï¼‰ |
| 2025-12-13 | 1.0.0 | ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆç®¡ç†UIï¼ˆStep 3.3å®Œäº†ï¼‰ã€ãƒã‚°ä¿®æ­£ã€ã‚¿ã‚¤ãƒ«è¡¨ç¤ºç¢ºèª |
| 2025-12-13 | 1.1.0 | ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ç®¡ç†UIï¼ˆStep 3.4å®Œäº†ï¼‰ã€MapLibre GL JSçµ±åˆã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ  |
| 2025-12-14 | 1.2.0 | è¨­å®šç”»é¢ï¼ˆStep 3.5å®Œäº†ï¼‰ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚¿ã‚¤ãƒ«ã‚»ãƒƒãƒˆæ•°è¡¨ç¤ºä¿®æ­£ |
| 2025-12-14 | 1.3.0 | GeoJSONã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆStep 3.7å®Œäº†ï¼‰ã€ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ä¸€è¦§ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³è¿½åŠ  |
| 2025-12-14 | 1.4.0 | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†UIï¼ˆStep 3.8å®Œäº†ï¼‰ã€PMTiles/COGæ¥ç¶šãƒ†ã‚¹ãƒˆã€aiopmtiles/rio-tileräº’æ›æ€§ä¿®æ­£ |
| 2025-12-14 | 1.4.1 | PMTiles TileJSONã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ500ã‚¨ãƒ©ãƒ¼ä¿®æ­£ï¼ˆgenerate_pmtiles_tilejsonå¼•æ•°ä¿®æ­£ï¼‰ |

---

*ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯2025-12-14æ™‚ç‚¹ã®æƒ…å ±ã§ã™ã€‚APIãƒãƒ¼ã‚¸ãƒ§ãƒ³: 0.4.0 / MCPãƒãƒ¼ã‚¸ãƒ§ãƒ³: 0.2.0 / Admin UIãƒãƒ¼ã‚¸ãƒ§ãƒ³: 0.7.0ï¼ˆPMTiles TileJSONä¿®æ­£å«ã‚€ï¼‰*
